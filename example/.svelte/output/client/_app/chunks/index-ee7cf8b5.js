import{C as n,s as t,D as s,E as e,F as r}from"./index-d2ff60c6.js";const c=[];function o(n,t){return{subscribe:u(n,t).subscribe}}function u(s,e=n){let r;const o=[];function u(n){if(t(s,n)&&(s=n,r)){const n=!c.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),c.push(n,s)}if(n){for(let n=0;n<c.length;n+=2)c[n][0](c[n+1]);c.length=0}}}return{set:u,update:function(n){u(n(s))},subscribe:function(t,c=n){const i=[t,c];return o.push(i),1===o.length&&(r=e(u)||n),t(s),()=>{const n=o.indexOf(i);-1!==n&&o.splice(n,1),0===o.length&&(r(),r=null)}}}}function i(t,c,u){const i=!Array.isArray(t),f=i?[t]:t,l=c.length<2;return o(u,(t=>{let o=!1;const u=[];let a=0,h=n;const g=()=>{if(a)return;h();const s=c(i?u[0]:u,t);l?t(s):h=r(s)?s:n},p=f.map(((n,t)=>s(n,(n=>{u[t]=n,a&=~(1<<t),o&&g()}),(()=>{a|=1<<t}))));return o=!0,g(),function(){e(p),h()}}))}export{i as d,o as r,u as w};
